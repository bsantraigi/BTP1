The Capture of Gibraltar by Anglo-Dutch forces of the Grand Alliance occurred between 1 and 4 August 1704 during the War of the Spanish Succession. Since the beginning of the war the Alliance had been looking for a harbour in the Iberian Peninsula to control the Strait of Gibraltar and facilitate naval operations against the French fleet in the western Mediterranean Sea. An attempt to seize Cdiz had ended in failure in September 1702, but following the Alliance fleet's successful raid in Vigo Bay in October that year, the combined fleets of the 'Maritime Powers', the Netherlands and England, had emerged as the dominant naval force in the region. This strength helped persuade King Peter II of Portugal to sever his alliance with France and Bourbon-controlled Spain, and ally himself with the Grand Alliance in 1703. Now with access to the Portuguese port of Lisbon the Alliance fleets could campaign in the Mediterranean, and conduct operations in support of the Austrian Habsburg candidate to the Spanish throne, the Archduke Charles, known to his supporters as Charles III of Spain.
Prince George of Hesse-Darmstadt represented the Habsburg cause in the region. In May 1704 the Prince and Admiral George Rooke, commander of the main Grand Alliance fleet, failed to take Barcelona in the name of 'Charles III'; Rooke subsequently evaded pressure from his allies to make another attempt on Cdiz. In order to compensate for their lack of success the Alliance commanders resolved to capture Gibraltar, a small town on the southern Spanish coast. Following a heavy bombardment the town was invaded by English and Dutch marines and sailors.  The governor, Diego de Salinas, agreed to surrender Gibraltar and its small garrison on 3 August. Three days later Prince George entered the town with Austrian and Spanish Habsburg troops in the name of Charles III of Spain. The Grand Alliance failed in its objective of replacing Philip V with Charles III as King of Spain, but in the peace negotiations Gibraltar was ceded to Britain.